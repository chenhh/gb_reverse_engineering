# RSA

在 RSA 加密方案中，選定了兩個質數p,q 計算出 N=pq, 再於小於ϕ\(N\)的正整數中選一個與其互質的正整數e作為公鑰，而e% ϕ\(N\)的乘法逆元d為私鑰，公開e，保留d。

公鑰加密，私鑰解密是一般的應用；理論上也可以私鑰加密，公鑰解密\(即公私鑰互換\)，但因為實作中對於公私鑰要求的強度不同，所以一般是用私鑰簽章，公鑰解簽章，而非用於加密。加密與簽章結合時，兩套公私鑰是不同的。

RSA 加密方案和 RSA 簽名方案是不同的:

* 既然是加密，那肯定是不希望別人知道我的訊息，所以只有我才能解密，所以可得出公鑰負責加密，私鑰負責解密；
* 既然是簽名，那肯定是不希望有人冒充我發訊息，只有我才能發佈這個簽名，所以可得出私鑰負責簽名，公鑰負責驗證。

## 生成鑰匙對

* 選定兩個質數 p=61, q=53，得到組合數 N=p\*q=3233。
* 計算 Euler number ϕ\(N\)=\(p-1\)\(q-1\)=3120。
* 求e滿足1 &lt; e &lt;ϕ\(N\) and gcd\(e, \(N\)\)=1，非唯一解，實作常選e=65537，假設e=17。
* 求d滿足 e\*d%ϕ\(N\)=1

  * xe+ϕ\(N\)y=1
  * 17x+3120y=1
  * x=2753, y=-15 =&gt; d=2753

  可得 

* public key: \(N,e\)=\(3233, 17\)
* private key :\(N,d\)=\(3233, 2753\)

 e和d 哪個標記為公鑰，在效能和安全性上有差別，通常e被標記為公鑰。

## 公鑰加密，私鑰解密



使用公鑰加密data=123，加密得

$$
123^e\ mod\ N = 123^{17} \ mod  \ 3233 = 855
$$

使用私鑰解密：

$$
855^d \ mod \ N = 855^{2753} \ mod \ 3233 = 123
$$

## 私鑰加密，公鑰解密

用私鑰加密data=99，加密得:

$$
99^d \ mod \ N = 99^{2753} \ mod \ 3233 = 89
$$

使用公鑰解密得:

$$
89^e \ mod \ N = 89^{17} \ mod \ 3233 = 99
$$



